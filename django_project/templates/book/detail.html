{% extends 'base.html'%}
{% load book_filter %}
{% block content %}

<script type="text/javascript">

function getLocation() {
    //alert("getLocation");

    
    if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(function(pos){
            sendLocation(pos.coords.latitude, pos.coords.longitude);
            /*
            $('#latitude').html(pos.coords.latitude);
            $('#longitude').html(pos.coords.longitude);
            */
            document.getElementById("needHide").style.display="none";
        });
    }
    else{
        alert("위치를 얻을 수 없습니다.");
    }
}

function showPosition(position) {
    x.innerHTML = "위도:" + position.coords.latitude + " 경도:" + position.coords.longitude;
}

function sendLocation(latitude, longitude) {
    var string = './?longitude='+longitude+'&latitude='+latitude;

    location.href=string;
}

function setKilo(kilo){
    switch(kilo){
        case 5:
            document.getElementById("showKilo").innerHTML = "범위 : 5km";
            break;

        case 10:
            document.getElementById("showKilo").innerHTML = "범위 : 10km";
            break;

        case 15:
            document.getElementById("showKilo").innerHTML = "범위 : 15km";
            break;

        case 20:
            document.getElementById("showKilo").innerHTML = "범위 : 20km";
            break;
        
        default:
        alert("Km 지정 에러");
    }

}


</script>

<div class="container">
    <form id="searchForm" method="get" action="{% url 'search:index' %}">
        <div class="input-group mb-3 input-group-lg">
            <input id="search" type="text" class="form-control" placeholder="검색어 입력" name="kw"
                   value="{{ kw|default_if_none:'' }}" aria-label="Recipient's username"
                   aria-describedby="button-addon2">
            <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="submit" id="button-addon2">검색</button>
            </div>
        </div>
    </form>
    <div class="space" style="margin-top: 84px"></div>

    <div class="searchList">
        <ul style="margin-bottom:40pt" class="resultList">
            <li class="item">
                <dl>
                    <!--
                        <dt class="tag">번호</dt>
                        <dd class="info">(1)<dd>
                    -->

                    <div class="rightInfo" style="display:inline-block; float: right">
                        <dt class="tag">표지</dt>
                        <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>

                    </div>
                    <div class="leftInfo">
                        <dt class="tag">제목</dt>
                        <dd class="info">
                            <a style="font-size:22px;">{{ detail.0.book.bookname }}</a>
                        </dd>
                        <dt class="tag">저자</dt>
                        <dd class="info">
                            <a><b>저자</b> : {{ detail.0.book.authors }}</a>
                        </dd>
                        <dt class="tag">출판사</dt>
                        <dd class="info">
                            <a><b>출판사</b> : {{ detail.0.book.publisher }}</a>
                        </dd>
                        <dt class="tag">출판일자</dt>
                        <dd class="info">
                            <a><b>출판일자</b> : {{ detail.0.book.publication_date }}</a>
                        </dd>
                        <dt class="tag">책소개</dt>
                        <dd class="info">
                            <div><b>책소개</b></div>
                            <a>{{ detail.0.book.description }}</a>
                        </dd>
                    </div>
                </dl>
            </li>
        </ul>

        <!--
            도서관
        -->
        <div class="libraryTableArea">
            <div style="position:relative;">

                <div style="margin-bottom:10pt" class="tableTitle">
                    <div style="" class="settingLibs">

                        <div style="float:right">
                            <div class="btn-group">
                                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown"
                                        aria-haspopup="true" aria-expanded="false">
                                    거리
                                </button>
                                <div class="dropdown-menu">
                                    <a onClick="setKilo(5)" id="5km" class="dropdown-item" href="#">5km 이내</a>
                                    <a onClick="setKilo(10)" id="10km" class="dropdown-item" href="#">10km 이내</a>
                                    <a onClick="setKilo(15)" id="15km" class="dropdown-item" href="#">15km 이내</a>
                                    <a onClick="setKilo(20)" id="20km" class="dropdown-item" href="#">20km 이내</a>
                                </div>
                            </div>
                            <h5 style="float:right" id="showKilo">기본 범위 : 5km</h5>
                            <button onclick="getLocation()" class="btn btn-info">내 위치</button>
                        </div>
                    </div>
                </div>
                <!-- 거리 선택 dropdown -->
                <h3 style="float:inline-block">도서관 리스트</h3>
            </div>


            <table style="margin-bottom:40pt" class="table table-hover" disabled="">
                <thead>
                <tr align="center">
                    <th scope="col">도서관명</th>

                    <th scope="col">운영시간</th>
                    <th scope="col">거리</th>
                    <th scope="col">소장여부</th>
                    <th scope="col">지도보기</th>
                </tr>
                </thead>
                <tbody>
                {% for library in libs %}
                <tr align="center">
                    <td>{{ library.lib.libName }}</td>

                    <td>{{ library.lib.operatingTime }}</td>
                    <td>{{ library.lib.distance }}km</td>
                    <td>{{ library.lib.result }}</td>
                    <td>
                        <button type="button" class="btn btn-success"
                                onclick="window.open('https://map.kakao.com/link/map/{{ library.lib.libName }},{{ library.lib.latitude }},{{ library.lib.longitude }}')">
                            지도
                        </button>
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>

            <div style="position:relative; left:45%; top:50%;">
            </div>
        </div>
        <!--여기에 추천 책 리스트 입력-->
        <div>
            <h3 class="infoTitle">추천 책 목록</h3>
        </div>

        <div>
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <!--
                    {% for library in libs %}
                        <div class="swiper-slide">
                            {% for book in library %}
                            <a>{{ book.lib.libName }}</a>
                            {% endfor %}
                        </div>
                    {% endfor %}
                    -->
                    <div class="swiper-slide">
                        <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>
                        <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>
                        <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>
                    </div>
                    <div class="swiper-slide">
                       <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>
                    </div>
                    <div class="swiper-slide">
                       <img class="info" src="{{ detail.0.book.bookImageURL }}" width="200" height="250"></img>
                    </div>
                </div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
                <script src="path/to/swiper.min.js"></script>
                <script id="rendered-js">
                var slide = new Swiper('.swiper-container', {
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                    autoplay: {
                        delay: 3000
                    }
                })
                </script>
            </div>
        </div>
        <!--
        <div class="infoArea" style="border: 1px solid gray">
        -->
        <!-- 책 5권 표시 예정
            <ul>
                <li>
                    <div>
                    </div>
                </li>
                <li>
                    <div>
                    </div>
                </li>
            </ul>
        </div>
        -->
    </div>
</div>

{% endblock %}